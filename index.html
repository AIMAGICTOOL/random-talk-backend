<!DOCTYPE html>
<html>
<head>
  <title>Random Talk - Real Chat</title>
  <style>
    body { font-family: Arial; background: #222; color: #fff; text-align: center; padding: 30px; }
    #chat { background: #333; border-radius: 10px; padding: 20px; height: 300px; overflow-y: auto; margin-bottom: 10px; }
    input, button { padding: 10px; margin: 5px; width: 80%; max-width: 400px; }
    .message { margin: 10px 0; }
    .you { color: #4fc3f7; }
    .stranger { color: #f06292; }
  </style>
</head>
<body>
  <h1>üßë‚Äçü§ù‚Äçüßë Random Chat</h1>
  <div id="status">Connecting...</div>
  <div id="chat"></div>
  <input type="text" id="messageInput" placeholder="Say something..." disabled />
  <button onclick="sendMessage()" disabled>Send</button>

  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  <script>
    const socket = io("https://random-talk-backend.onrender.com");
    const statusDiv = document.getElementById("status");
    const input = document.getElementById("messageInput");
    const button = document.querySelector("button");
    const chat = document.getElementById("chat");

    socket.on("waiting", () => {
      statusDiv.textContent = "Waiting for a stranger...";
    });

    socket.on("match_found", () => {
      statusDiv.textContent = "Stranger connected!";
      input.disabled = false;
      button.disabled = false;
    });

    socket.on("receive_message", (msg) => {
      const div = document.createElement("div");
      div.className = "message stranger";
      div.textContent = "Stranger: " + msg;
      chat.appendChild(div);
      chat.scrollTop = chat.scrollHeight;
    });

    socket.on("partner_disconnected", () => {
      const div = document.createElement("div");
      div.className = "message";
      div.textContent = "Stranger disconnected.";
      chat.appendChild(div);
      input.disabled = true;
      button.disabled = true;
      statusDiv.textContent = "Stranger left. Please refresh to reconnect.";
    });

    function sendMessage() {
      const msg = input.value;
      if (!msg) return;
      socket.emit("send_message", msg);
      const div = document.createElement("div");
      div.className = "message you";
      div.textContent = "You: " + msg;
      chat.appendChild(div);
      input.value = "";
      chat.scrollTop = chat.scrollHeight;
    }
  </script>
</body>
</html>
